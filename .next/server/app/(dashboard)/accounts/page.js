(()=>{var a={};a.id=147,a.ids=[147],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10578:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15458:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["(dashboard)",{children:["accounts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,15893)),"C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\(dashboard)\\accounts\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,86457)),"C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\(dashboard)\\layout.tsx"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,16953)),"C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.bind(c,8595)),"C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\(dashboard)\\accounts\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/(dashboard)/accounts/page",pathname:"/accounts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/(dashboard)/accounts/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},15893:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\LAPPYFY\\\\Desktop\\\\Projects\\\\zoravo-oms\\\\app\\\\(dashboard)\\\\accounts\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\LAPPYFY\\Desktop\\Projects\\zoravo-oms\\app\\(dashboard)\\accounts\\page.tsx","default")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23405:a=>{"use strict";a.exports=require("@supabase/ssr")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{"use strict";a.exports=require("util")},29100:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>B});var d=c(21124),e=c(38301),f=c(49269),g=c(3663),h=c(32717),i=c(67748),j=c(89710),k=c(88285),l=c(30087),m=c(72567),n=c(69957),o=c(10578),p=c(70045),q=c(89023),r=c(28731);let s=(0,r.A)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var t=c(84122),u=c(47089),v=c(81100);let w=(0,r.A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var x=c(43700);let y=(0,r.A)("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);var z=c(10643),A=c(61407);function B(){let[a,b]=(0,e.useState)(""),[c,r]=(0,e.useState)("entries"),[B,C]=(0,e.useState)([]),[D,E]=(0,e.useState)([]),[F,G]=(0,e.useState)(!0),[H,I]=(0,e.useState)(!1),[J,K]=(0,e.useState)("all"),[L,M]=(0,e.useState)(""),[N,O]=(0,e.useState)(""),[P,Q]=(0,e.useState)(new Map),[R,S]=(0,e.useState)(new Map),[T,U]=(0,e.useState)(new Map),[V,W]=(0,e.useState)(new Map),[X,Y]=(0,e.useState)(null),[Z,$]=(0,e.useState)(!1),[_,aa]=(0,e.useState)([]),[ab,ac]=(0,e.useState)(!1),[ad,ae]=(0,e.useState)(""),[af,ag]=(0,e.useState)(null),[ah,ai]=(0,e.useState)([]),[aj,ak]=(0,e.useState)(!1),[al,am]=(0,e.useState)(!1),[an,ao]=(0,e.useState)("accountant"),[ap,aq]=(0,e.useState)(!1),[ar,as]=(0,e.useState)(""),[at,au]=(0,e.useState)(""),[av,aw]=(0,e.useState)(""),[ax,ay]=(0,e.useState)(!1),az=(0,z.U)(),aA=async()=>{if(X)try{let{data:a}=await az.from("vehicle_inward_comments").select("*").eq("vehicle_inward_id",X.id).like("comment","INVOICE_REF:%").order("created_at",{ascending:!1});if(a&&a.length>0){let b=a.map(a=>a.id),{data:c}=await az.from("vehicle_inward_comment_attachments").select("*").in("comment_id",b),d={};c&&c.forEach(a=>{d[a.comment_id]=a});let e=a.map(a=>{let b=a.comment.match(/INVOICE_REF:(link|file|image):(.+)/);if(b){let c=d[a.id];return{type:b[1],url:c?c.file_url:b[2],fileName:c?c.file_name:b[2],uploadedAt:a.created_at}}return null}).filter(Boolean);ai(e)}else ai([])}catch(a){console.error("Error loading invoice references:",a),ai([])}},aB=async()=>{try{I(!0);let a=az.from("vehicle_inward").select("*").in("status",["completed","complete_and_delivered","delivered","delivered_final","delivered (final)"]).order("updated_at",{ascending:!1}),b=null,c=new Date;switch(J){case"today":{let a=new Date(c);a.setHours(0,0,0,0),b=a;break}case"week":{let a=new Date(c);a.setDate(a.getDate()-7),b=a;break}case"month":{let a=new Date(c);a.setMonth(a.getMonth()-1),b=a;break}case"year":{let a=new Date(c);a.setFullYear(a.getFullYear()-1),b=a;break}case"custom":L&&(b=new Date(L))}if(b&&(a=a.gte("updated_at",b.toISOString())),"custom"===J&&N){let b=new Date(N);b.setHours(23,59,59,999),a=a.lte("updated_at",b.toISOString())}let{data:d,error:e}=await a;if(e)throw e;if(d&&d.length>0){let a=d.map(a=>{let b=[],c=0;if(a.accessories_requested)try{let d=JSON.parse(a.accessories_requested);Array.isArray(d)&&(b=d.map(a=>{let b=parseFloat(a.price||0);return c+=b,{product:a.product||"",brand:a.brand||"",price:b,department:a.department||""}}))}catch{}let d=0,e=0,f="",g="";if(a.notes)try{let b=JSON.parse(a.notes);b.discount&&(d=parseFloat(b.discount.discount_amount||0),e=b.discount.discount_percentage||(c>0?d/c*100:0),f=b.discount.discount_offered_by||"",g=b.discount.discount_reason||"")}catch{(d=parseFloat(a.discount_amount||0))>0&&c>0&&(e=d/c*100)}else(d=parseFloat(a.discount_amount||0))>0&&c>0&&(e=d/c*100),f=a.discount_offered_by||a.discount_offered_by_name||"",g=a.discount_reason||"";let h=c-d;return{id:a.id,shortId:a.short_id||a.id.substring(0,8),customerName:a.customer_name||"N/A",customerPhone:a.customer_phone||"N/A",customerEmail:a.customer_email,vehicleNumber:a.registration_number||"N/A",model:a.model||"N/A",make:a.make||"Unknown",year:a.year,color:a.color,vehicleType:a.vehicle_type,location:a.location_id,manager:a.assigned_manager_id,installationCompleteDate:a.updated_at||a.created_at,expectedDelivery:a.estimated_completion_date,products:b,totalAmount:c,status:a.status,created_at:a.created_at,completed_at:a.updated_at,discountAmount:d,discountPercentage:e,discountOfferedBy:f,discountReason:g,finalAmount:h}});E(a)}else E([])}catch(a){console.error("Error fetching completed entries:",a),E([])}finally{I(!1)}},aC=async()=>{try{G(!0);let{data:a,error:b}=await az.from("vehicle_inward").select("*").eq("status","installation_complete").order("updated_at",{ascending:!1});if(b)throw b;if(a&&a.length>0){let b=a.map(a=>{let b=[],c=0;if(a.accessories_requested)try{let d=JSON.parse(a.accessories_requested);Array.isArray(d)&&(b=d.map(a=>{let b=parseFloat(a.price||0);return c+=b,{product:a.product||"",brand:a.brand||"",price:b,department:a.department||""}}))}catch{}return{id:a.id,shortId:a.short_id||a.id.substring(0,8),customerName:a.customer_name||"N/A",customerPhone:a.customer_phone||"N/A",customerEmail:a.customer_email,vehicleNumber:a.registration_number||"N/A",model:a.model||"N/A",make:a.make||"Unknown",year:a.year,color:a.color,vehicleType:a.vehicle_type,location:a.location_id,manager:a.assigned_manager_id,installationCompleteDate:a.updated_at||a.created_at,expectedDelivery:a.estimated_completion_date,products:b,totalAmount:c,status:a.status,created_at:a.created_at}});C(b)}else C([])}catch(a){console.error("Error fetching account entries:",a),C([])}finally{G(!1)}},aD=B.filter(b=>{let c=a.toLowerCase();return b.customerName.toLowerCase().includes(c)||b.vehicleNumber.toLowerCase().includes(c)||b.model.toLowerCase().includes(c)||b.shortId?.toLowerCase().includes(c)}),aE=aD.length,aF=aD.reduce((a,b)=>a+b.totalAmount,0),aG=D.filter(b=>{let c=a.toLowerCase();return b.customerName.toLowerCase().includes(c)||b.vehicleNumber.toLowerCase().includes(c)||b.model.toLowerCase().includes(c)||b.shortId?.toLowerCase().includes(c)}),aH=aG.length,aI=aG.reduce((a,b)=>a+(b.finalAmount||b.totalAmount),0),aJ=aG.reduce((a,b)=>a+b.totalAmount,0),aK=aG.reduce((a,b)=>a+(b.discountAmount||0),0),aL=aH>0?aK/aH:0,aM=aJ>0?aK/aJ*100:0,aN=aH>0?aI/aH:0,aO=aG.filter(a=>(a.discountAmount||0)>0).length,aP=aH>0?aO/aH*100:0,aQ="completed"===c?aH:aE,aR="completed"===c?aI:aF,aS="completed"===c?aN:aE>0?aF/aE:0,aT=a=>a?new Date(a).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",aU=a=>`₹${a.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,aV=a=>["Entry ID,Customer Name,Phone,Email,Vehicle Number,Model,Make,Location,Manager,Completed Date,Original Amount,Discount Amount,Discount %,Discount Offered By,Discount Reason,Final Amount,Product Count",...a.map(a=>[a.shortId||a.id.substring(0,8),a.customerName,a.customerPhone,a.customerEmail||"",a.vehicleNumber,a.model,a.make,a.location?P.get(a.location)||a.location:"",a.manager?T.get(a.manager)||a.manager:"",a.completed_at?aT(a.completed_at):"",a.totalAmount.toString(),(a.discountAmount||0).toString(),(a.discountPercentage||0).toFixed(2),a.discountOfferedBy||"",a.discountReason||"",(a.finalAmount||a.totalAmount).toString(),a.products.length.toString()]).map(a=>a.map(a=>`"${a}"`).join(","))].join("\n"),aW=(a,b)=>{let c=new Blob([a],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),e=URL.createObjectURL(c);d.setAttribute("href",e),d.setAttribute("download",b),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)},aX=(a,b,c)=>{let d=[..._];d[a]={...d[a],[b]:c},aa(d)},aY=async()=>{if(X)try{ac(!0);let a=JSON.stringify(_),{error:b}=await az.from("vehicle_inward").update({accessories_requested:a}).eq("id",X.id);if(b)throw b;let c=_.reduce((a,b)=>a+b.price,0),d={...X,products:_,totalAmount:c};Y(d),C(B.map(a=>a.id===X.id?d:a)),$(!1),alert("Product details updated successfully!"),await aC()}catch(a){console.error("Error saving products:",a),alert(`Failed to save products: ${a.message}`)}finally{ac(!1)}},aZ=async()=>{if(ad.trim()&&X)try{ak(!0);let{data:{user:a}}=await az.auth.getUser(),{error:b}=await az.from("vehicle_inward_comments").insert({vehicle_inward_id:X.id,comment:`INVOICE_REF:link:${ad}`,created_by:a?.email||a?.id||"accountant",role:"accountant"});if(b)throw b;ae(""),await aA(),alert("Invoice link added successfully!")}catch(a){console.error("Error adding invoice link:",a),alert(`Failed to add invoice link: ${a.message}`)}finally{ak(!1)}},a$=async()=>{if(af&&X)try{ak(!0);let{data:{user:a}}=await az.auth.getUser(),b=new FileReader;b.onload=async b=>{let c=b.target?.result,{data:d,error:e}=await az.from("vehicle_inward_comments").insert({vehicle_inward_id:X.id,comment:`INVOICE_REF:${af.type.startsWith("image/")?"image":"file"}:${af.name}`,created_by:a?.email||a?.id||"accountant",role:"accountant"}).select().single();if(e)throw e;let{error:f}=await az.from("vehicle_inward_comment_attachments").insert({comment_id:d.id,file_name:af.name,file_url:c,file_type:af.type,file_size:af.size});if(f)throw f;await az.from("vehicle_inward_comments").update({attachments_count:1}).eq("id",d.id),ag(null),await aA(),alert("Invoice uploaded successfully!"),ak(!1)},b.readAsDataURL(af)}catch(a){console.error("Error uploading invoice:",a),alert(`Failed to upload invoice: ${a.message}`),ak(!1)}},a_=async()=>{if(X&&confirm("Are you sure you want to mark this entry as Complete? This will finalize the accountant's work."))try{am(!0);let{error:a}=await az.from("vehicle_inward").update({status:"completed"}).eq("id",X.id);if(a)throw a;let b=B.filter(a=>a.id!==X.id);C(b),alert("Entry marked as Complete! The entry has been removed from the Accounts list."),Y(null),await aC()}catch(a){console.error("Error updating status:",a),alert(`Failed to update status: ${a.message}`)}finally{am(!1)}};return F?(0,d.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#f8fafc"},children:(0,d.jsxs)("div",{style:{textAlign:"center"},children:[(0,d.jsx)("div",{style:{border:"4px solid #e5e7eb",borderTop:"4px solid #2563eb",borderRadius:"50%",width:"3rem",height:"3rem",animation:"spin 1s linear infinite",margin:"0 auto 1rem"}}),(0,d.jsx)("style",{children:`
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `}),(0,d.jsx)("p",{style:{color:"#6b7280"},children:"Loading account entries..."})]})}):(0,d.jsxs)("div",{style:{backgroundColor:"#f8fafc",minHeight:"100vh",fontFamily:"system-ui, -apple-system, sans-serif"},children:[(0,d.jsxs)("div",{style:{backgroundColor:"white",borderBottom:"1px solid #e2e8f0",padding:"1.5rem 2rem"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b",margin:0},children:"Accounts"}),(0,d.jsx)("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0.5rem 0 0 0"},children:"Manage invoicing for completed installations"})]}),(0,d.jsxs)("button",{onClick:()=>{aW("completed"===c?aV(aG):["Entry ID,Customer Name,Phone,Email,Vehicle Number,Model,Make,Year,Color,Vehicle Type,Location,Manager,Installation Complete Date,Expected Delivery,Product Details,Total Amount",...B.map(a=>{let b=a.products.map(a=>`${a.product} (${a.brand}) - ${aU(a.price)}`).join("; ");return[a.shortId||a.id.substring(0,8),a.customerName,a.customerPhone,a.customerEmail||"",a.vehicleNumber,a.model,a.make,a.year?.toString()||"",a.color||"",a.vehicleType?R.get(a.vehicleType)||a.vehicleType:"",a.location?P.get(a.location)||a.location:"",a.manager?T.get(a.manager)||a.manager:"",aT(a.installationCompleteDate),a.expectedDelivery?new Date(a.expectedDelivery).toLocaleDateString("en-IN"):"",b,a.totalAmount.toString()]}).map(a=>a.map(a=>`"${a}"`).join(","))].join("\n"),"completed"===c?"completed_entries.csv":"account_entries.csv")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 4px rgba(5, 150, 105, 0.2)",transition:"all 0.2s"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="#047857",onMouseLeave:a=>a.currentTarget.style.backgroundColor="#059669",children:[(0,d.jsx)(f.A,{style:{width:"1rem",height:"1rem"}}),"Export All to CSV"]})]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginTop:"1.5rem"},children:[(0,d.jsxs)("div",{style:{backgroundColor:"#eff6ff",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #bfdbfe"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Total Entries"}),(0,d.jsx)(g.A,{style:{width:"1.25rem",height:"1.25rem",color:"#3b82f6"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aQ}),(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:"completed"===c?"Completed entries":"Ready for invoicing"})]}),(0,d.jsxs)("div",{style:{backgroundColor:"#dcfce7",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #bbf7d0"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Total Revenue"}),(0,d.jsx)(h.A,{style:{width:"1.25rem",height:"1.25rem",color:"#059669"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aU(aR)}),(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:"completed"===c?"Final revenue (after discounts)":"From all entries"})]}),(0,d.jsxs)("div",{style:{backgroundColor:"#fef3c7",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #fde68a"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Average Order"}),(0,d.jsx)(i.A,{style:{width:"1.25rem",height:"1.25rem",color:"#d97706"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aU(aS)}),(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:"completed"===c?"Avg final order value":"Per installation"})]})]})]}),(0,d.jsx)("div",{style:{backgroundColor:"white",borderBottom:"1px solid #e2e8f0",padding:"0 2rem"},children:(0,d.jsxs)("div",{style:{display:"flex",gap:"2rem"},children:[(0,d.jsxs)("button",{onClick:()=>r("entries"),style:{padding:"1rem 0",border:"none",backgroundColor:"transparent",color:"entries"===c?"#2563eb":"#64748b",fontWeight:"entries"===c?"600":"400",borderBottom:"entries"===c?"3px solid #2563eb":"3px solid transparent",cursor:"pointer",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s"},children:[(0,d.jsx)(g.A,{style:{width:"1rem",height:"1rem"}}),"Account Entries"]}),(0,d.jsxs)("button",{onClick:()=>{r("completed"),aB()},style:{padding:"1rem 0",border:"none",backgroundColor:"transparent",color:"completed"===c?"#2563eb":"#64748b",fontWeight:"completed"===c?"600":"400",borderBottom:"completed"===c?"3px solid #2563eb":"3px solid transparent",cursor:"pointer",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s"},children:[(0,d.jsx)(j.A,{style:{width:"1rem",height:"1rem"}}),"Completed"]})]})}),(0,d.jsxs)("div",{style:{padding:"2rem"},children:["entries"===c&&(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",border:"1px solid #e2e8f0",overflow:"hidden"},children:[(0,d.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsxs)("div",{style:{position:"relative",flex:1,maxWidth:"400px"},children:[(0,d.jsx)(k.A,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem",color:"#94a3b8"}}),(0,d.jsx)("input",{type:"text",placeholder:"Search by customer, vehicle number, or entry ID...",value:a,onChange:a=>b(a.target.value),style:{width:"100%",padding:"0.625rem 0.75rem 0.625rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"0.5rem",fontSize:"0.875rem",outline:"none",backgroundColor:"white",transition:"border-color 0.2s"},onFocus:a=>{a.target.style.borderColor="#2563eb",a.target.style.boxShadow="0 0 0 3px rgba(37, 99, 235, 0.1)"},onBlur:a=>{a.target.style.borderColor="#e2e8f0",a.target.style.boxShadow="none"}})]}),(0,d.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:[aD.length," ",1===aD.length?"entry":"entries"]})]}),(0,d.jsx)("div",{style:{maxHeight:"calc(100vh - 400px)",overflowY:"auto"},children:0===aD.length?(0,d.jsxs)("div",{style:{padding:"4rem 2rem",textAlign:"center"},children:[(0,d.jsx)(g.A,{style:{width:"3rem",height:"3rem",color:"#cbd5e1",margin:"0 auto 1rem"}}),(0,d.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.5rem"},children:a?"No entries found":"No entries available"}),(0,d.jsx)("p",{style:{fontSize:"0.875rem",color:"#64748b"},children:a?"Try adjusting your search terms":'Entries with "Installation Complete" status will appear here'})]}):(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1.5rem"},children:aD.map(a=>(0,d.jsxs)("div",{onClick:()=>Y(a),style:{backgroundColor:X?.id===a.id?"#eff6ff":"#f9fafb",borderRadius:"0.75rem",border:X?.id===a.id?"2px solid #2563eb":"1px solid #e2e8f0",padding:"1.5rem",cursor:"pointer",transition:"all 0.2s",boxShadow:X?.id===a.id?"0 4px 6px -1px rgba(37, 99, 235, 0.1)":"0 1px 2px rgba(0,0,0,0.05)"},onMouseEnter:b=>{X?.id!==a.id&&(b.currentTarget.style.backgroundColor="#f1f5f9",b.currentTarget.style.borderColor="#cbd5e1")},onMouseLeave:b=>{X?.id!==a.id&&(b.currentTarget.style.backgroundColor="#f9fafb",b.currentTarget.style.borderColor="#e2e8f0")},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,d.jsxs)("div",{style:{flex:1},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[(0,d.jsx)("div",{style:{padding:"0.25rem 0.75rem",backgroundColor:"#059669",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"600"},children:a.shortId||a.id.substring(0,8)}),(0,d.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"700",color:"#1e293b",margin:0},children:a.customerName}),(0,d.jsxs)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:"#dcfce7",color:"#166534",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,d.jsx)(j.A,{style:{width:"0.75rem",height:"0.75rem"}}),"Installation Complete"]})]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",fontSize:"0.875rem",color:"#64748b"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(l.A,{style:{width:"1rem",height:"1rem"}}),(0,d.jsxs)("span",{children:[a.model," (",a.vehicleNumber,")"]})]}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(m.A,{style:{width:"1rem",height:"1rem"}}),(0,d.jsxs)("span",{children:["Completed: ",aT(a.installationCompleteDate)]})]}),a.location&&(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(n.A,{style:{width:"1rem",height:"1rem"}}),(0,d.jsx)("span",{children:P.get(a.location)||a.location})]}),a.manager&&(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(o.A,{style:{width:"1rem",height:"1rem"}}),(0,d.jsx)("span",{children:T.get(a.manager)||a.manager})]})]})]}),(0,d.jsxs)("div",{style:{textAlign:"right"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.25rem"},children:"Total Amount"}),(0,d.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#059669"},children:aU(a.totalAmount)}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:[a.products.length," ",1===a.products.length?"product":"products"]})]})]}),a.products.length>0&&(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1rem",border:"1px solid #e2e8f0",marginTop:"1rem"},children:[(0,d.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(p.A,{style:{width:"1rem",height:"1rem"}}),"Product Details (",a.products.length,")"]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"0.75rem"},children:[a.products.slice(0,3).map((a,b)=>(0,d.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:a.product}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"0.25rem"},children:["Brand: ",a.brand," | ",V.get(a.department)||a.department]}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"700",color:"#059669"},children:aU(a.price)})]},b)),a.products.length>3&&(0,d.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"#eff6ff",borderRadius:"0.5rem",border:"1px solid #bfdbfe",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",color:"#2563eb",fontWeight:"500"},children:["+",a.products.length-3," more"]})]})]})]},a.id))})})]}),"completed"===c&&(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"1.5rem"},children:[(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",padding:"1.5rem",border:"1px solid #e2e8f0"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(q.A,{style:{width:"1.25rem",height:"1.25rem",color:"#2563eb"}}),(0,d.jsx)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",margin:0},children:"Time Period Filter"})]}),(0,d.jsxs)("button",{onClick:()=>{let a=aV(aG),b="all"===J?"all_time":"custom"===J?`custom_${L||"range"}_${N||"range"}`:`last_${J}`;aW(a,`completed_entries_${b}_${new Date().toISOString().split("T")[0]}.csv`)},disabled:0===aG.length,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:0===aG.length?"#f3f4f6":"#059669",color:0===aG.length?"#9ca3af":"white",border:"none",borderRadius:"0.5rem",fontSize:"0.75rem",fontWeight:"600",cursor:0===aG.length?"not-allowed":"pointer",transition:"all 0.2s"},onMouseEnter:a=>{aG.length>0&&(a.currentTarget.style.backgroundColor="#047857")},onMouseLeave:a=>{aG.length>0&&(a.currentTarget.style.backgroundColor="#059669")},title:0===aG.length?"No data to export":`Export ${aG.length} entries`,children:[(0,d.jsx)(f.A,{style:{width:"0.875rem",height:"0.875rem"}}),"Export CSV"]})]}),(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:["all","today","week","month","year","custom"].map(a=>(0,d.jsx)("button",{onClick:()=>K(a),style:{padding:"0.75rem 1rem",backgroundColor:J===a?"#eff6ff":"#f9fafb",color:J===a?"#2563eb":"#374151",border:J===a?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:J===a?"600":"400",cursor:"pointer",textAlign:"left",textTransform:"capitalize",transition:"all 0.2s"},children:"all"===a?"All Time":"custom"===a?"Custom Range":`Last ${a}`},a))}),"custom"===J&&(0,d.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem",display:"block"},children:"Start Date"}),(0,d.jsx)("input",{type:"date",value:L,onChange:a=>M(a.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem",display:"block"},children:"End Date"}),(0,d.jsx)("input",{type:"date",value:N,onChange:a=>O(a.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}})]})]})]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[(0,d.jsxs)("div",{style:{backgroundColor:"#eff6ff",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #bfdbfe"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Completed Entries"}),(0,d.jsx)(j.A,{style:{width:"1.25rem",height:"1.25rem",color:"#3b82f6"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aH}),(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:H?"Loading...":"In selected period"})]}),(0,d.jsxs)("div",{style:{backgroundColor:"#dcfce7",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #bbf7d0"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Final Revenue"}),(0,d.jsx)(h.A,{style:{width:"1.25rem",height:"1.25rem",color:"#059669"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aU(aI)}),(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:"After discounts"})]}),(0,d.jsxs)("div",{style:{backgroundColor:"#fef3c7",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #fde68a"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b",fontWeight:"500"},children:"Total Discounts"}),(0,d.jsx)(s,{style:{width:"1.25rem",height:"1.25rem",color:"#d97706"}})]}),(0,d.jsx)("div",{style:{fontSize:"1.875rem",fontWeight:"700",color:"#1e293b"},children:aU(aK)}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:[aM.toFixed(1),"% of revenue"]})]})]})]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.5rem"},children:"Avg Order Value"}),(0,d.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#1e293b"},children:aU(aN)})]}),(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.5rem"},children:"Avg Discount"}),(0,d.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#ef4444"},children:aU(aL)})]}),(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.5rem"},children:"Discount Ratio"}),(0,d.jsxs)("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#1e293b"},children:[aP.toFixed(1),"%"]}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:[aO," of ",aH," entries"]})]}),(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.5rem"},children:"Original Revenue"}),(0,d.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#1e293b"},children:aU(aJ)})]})]}),(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",border:"1px solid #e2e8f0",overflow:"hidden"},children:[(0,d.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsxs)("div",{style:{position:"relative",flex:1,maxWidth:"400px"},children:[(0,d.jsx)(k.A,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem",color:"#94a3b8"}}),(0,d.jsx)("input",{type:"text",placeholder:"Search completed entries...",value:a,onChange:a=>b(a.target.value),style:{width:"100%",padding:"0.625rem 0.75rem 0.625rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"0.5rem",fontSize:"0.875rem",outline:"none",backgroundColor:"white"}})]}),(0,d.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:[aG.length," ",1===aG.length?"entry":"entries"]})]}),(0,d.jsx)("div",{style:{maxHeight:"calc(100vh - 500px)",overflowY:"auto",padding:"1.5rem"},children:H?(0,d.jsxs)("div",{style:{padding:"4rem 2rem",textAlign:"center"},children:[(0,d.jsx)("div",{style:{border:"4px solid #e5e7eb",borderTop:"4px solid #2563eb",borderRadius:"50%",width:"3rem",height:"3rem",animation:"spin 1s linear infinite",margin:"0 auto 1rem"}}),(0,d.jsx)("p",{style:{color:"#6b7280"},children:"Loading completed entries..."})]}):0===aG.length?(0,d.jsxs)("div",{style:{padding:"4rem 2rem",textAlign:"center"},children:[(0,d.jsx)(j.A,{style:{width:"3rem",height:"3rem",color:"#cbd5e1",margin:"0 auto 1rem"}}),(0,d.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.5rem"},children:a?"No entries found":"No completed entries in selected period"}),(0,d.jsx)("p",{style:{fontSize:"0.875rem",color:"#64748b"},children:a?"Try adjusting your search terms":"Completed entries will appear here"})]}):(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:aG.map(a=>(0,d.jsx)("div",{onClick:()=>Y(a),style:{backgroundColor:X?.id===a.id?"#eff6ff":"#f9fafb",borderRadius:"0.75rem",border:X?.id===a.id?"2px solid #2563eb":"1px solid #e2e8f0",padding:"1.5rem",cursor:"pointer",transition:"all 0.2s"},children:(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,d.jsxs)("div",{style:{flex:1},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[(0,d.jsx)("div",{style:{padding:"0.25rem 0.75rem",backgroundColor:"#10b981",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"600"},children:a.shortId||a.id.substring(0,8)}),(0,d.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"700",color:"#1e293b",margin:0},children:a.customerName}),(0,d.jsx)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:"#dcfce7",color:"#166534",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600"},children:"Completed"})]}),(0,d.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.5rem"},children:[a.model," • ",a.vehicleNumber]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",fontSize:"0.875rem",color:"#64748b"},children:[a.location&&(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(n.A,{style:{width:"1rem",height:"1rem"}}),P.get(a.location)||a.location]}),a.completed_at&&(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(m.A,{style:{width:"1rem",height:"1rem"}}),"Completed: ",aT(a.completed_at)]})]})]}),(0,d.jsxs)("div",{style:{textAlign:"right"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.25rem"},children:a.discountAmount&&a.discountAmount>0?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{textDecoration:"line-through",color:"#9ca3af"},children:aU(a.totalAmount)}),(0,d.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#10b981",marginTop:"0.25rem"},children:aU(a.finalAmount||a.totalAmount)}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#ef4444",marginTop:"0.25rem"},children:["-",aU(a.discountAmount)," (",a.discountPercentage?.toFixed(1),"%)"]}),a.discountOfferedBy&&(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:["By: ",a.discountOfferedBy]})]}):(0,d.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#059669"},children:aU(a.totalAmount)})}),(0,d.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:[a.products.length," ",1===a.products.length?"product":"products"]})]})]})},a.id))})})]})]})]}),X&&(0,d.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},onClick:()=>Y(null),children:(0,d.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",width:"100%",maxWidth:"900px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 50px rgba(0,0,0,0.25)"},onClick:a=>a.stopPropagation(),children:[(0,d.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,backgroundColor:"white",zIndex:10},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#1e293b",margin:0},children:"Account Entry Details"}),(0,d.jsx)("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0.25rem 0 0 0"},children:X.shortId||X.id.substring(0,8)})]}),(0,d.jsx)("button",{onClick:()=>Y(null),style:{padding:"0.5rem",backgroundColor:"#f3f4f6",border:"none",borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",fontSize:"1.25rem",color:"#6b7280"},children:"\xd7"})]}),(0,d.jsxs)("div",{style:{padding:"1.5rem"},children:[(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(o.A,{style:{width:"1.25rem",height:"1.25rem"}}),"Customer Information"]}),(0,d.jsx)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"0.75rem",padding:"1.25rem"},children:(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Name"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.customerName})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Phone"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.customerPhone})]}),X.customerEmail&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Email"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.customerEmail})]})]})})]}),(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(l.A,{style:{width:"1.25rem",height:"1.25rem"}}),"Vehicle Information"]}),(0,d.jsx)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"0.75rem",padding:"1.25rem"},children:(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Vehicle Number"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.vehicleNumber})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Model"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.model})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Make"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.make})]}),X.year&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Year"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.year})]}),X.color&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Color"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.color})]}),X.vehicleType&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Vehicle Type"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:R.get(X.vehicleType)||X.vehicleType})]})]})})]}),(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(m.A,{style:{width:"1.25rem",height:"1.25rem"}}),"Installation Details"]}),(0,d.jsx)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"0.75rem",padding:"1.25rem"},children:(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Installation Complete Date"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:aT(X.installationCompleteDate)})]}),X.expectedDelivery&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Expected Delivery"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:new Date(X.expectedDelivery).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),X.location&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Location"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:P.get(X.location)||X.location})]}),X.manager&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Assigned Manager"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:T.get(X.manager)||X.manager})]})]})})]}),(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",display:"flex",alignItems:"center",gap:"0.5rem",margin:0},children:[(0,d.jsx)(p.A,{style:{width:"1.25rem",height:"1.25rem"}}),"Product Details & Pricing"]}),!Z&&(0,d.jsxs)("button",{onClick:()=>{$(!0),aa([...X.products])},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="#1d4ed8",onMouseLeave:a=>a.currentTarget.style.backgroundColor="#2563eb",children:[(0,d.jsx)(t.A,{style:{width:"1rem",height:"1rem"}}),"Edit Products"]})]}),(0,d.jsx)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",border:"1px solid #e5e7eb",overflow:"hidden"},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,d.jsx)("thead",{style:{backgroundColor:"#f9fafb"},children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#374151",borderBottom:"1px solid #e5e7eb"},children:"Product"}),(0,d.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#374151",borderBottom:"1px solid #e5e7eb"},children:"Brand"}),(0,d.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#374151",borderBottom:"1px solid #e5e7eb"},children:"Department"}),(0,d.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#374151",borderBottom:"1px solid #e5e7eb"},children:"Price"})]})}),(0,d.jsx)("tbody",{children:_.length>0?_.map((a,b)=>(0,d.jsxs)("tr",{style:{borderBottom:b<_.length-1?"1px solid #f3f4f6":"none"},children:[(0,d.jsx)("td",{style:{padding:"0.75rem 1rem"},children:Z?(0,d.jsx)("input",{type:"text",value:a.product,onChange:a=>aX(b,"product",a.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}}):(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#1e293b",fontWeight:"500"},children:a.product})}),(0,d.jsx)("td",{style:{padding:"0.75rem 1rem"},children:Z?(0,d.jsx)("input",{type:"text",value:a.brand,onChange:a=>aX(b,"brand",a.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}}):(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:a.brand})}),(0,d.jsx)("td",{style:{padding:"0.75rem 1rem"},children:Z?(0,d.jsx)("select",{value:a.department,onChange:a=>aX(b,"department",a.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white"},children:Array.from(V.entries()).map(([a,b])=>(0,d.jsx)("option",{value:a,children:b},a))}):(0,d.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:V.get(a.department)||a.department})}),(0,d.jsx)("td",{style:{padding:"0.75rem 1rem",textAlign:"right"},children:Z?(0,d.jsx)("input",{type:"number",value:a.price,onChange:a=>aX(b,"price",parseFloat(a.target.value)||0),min:"0",step:"0.01",style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",textAlign:"right"}}):(0,d.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#059669"},children:aU(a.price)})})]},b)):(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:4,style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:"No products listed"})})}),(0,d.jsx)("tfoot",{style:{backgroundColor:"#f9fafb",borderTop:"2px solid #e5e7eb"},children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{colSpan:3,style:{padding:"1rem",fontSize:"1rem",fontWeight:"700",color:"#1e293b",textAlign:"right"},children:"Total Amount:"}),(0,d.jsx)("td",{style:{padding:"1rem",fontSize:"1.125rem",fontWeight:"700",color:"#059669",textAlign:"right"},children:aU(_.reduce((a,b)=>a+b.price,0))})]})})]})}),Z&&(0,d.jsxs)("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"1rem"},children:[(0,d.jsxs)("button",{onClick:()=>{$(!1),X&&aa([...X.products])},style:{padding:"0.5rem 1rem",backgroundColor:"#f3f4f6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},children:[(0,d.jsx)(u.A,{style:{width:"1rem",height:"1rem",display:"inline",marginRight:"0.25rem"}}),"Cancel"]}),(0,d.jsxs)("button",{onClick:aY,disabled:ab,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:ab?"#9ca3af":"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:ab?"not-allowed":"pointer",transition:"all 0.2s"},children:[(0,d.jsx)(v.A,{style:{width:"1rem",height:"1rem"}}),ab?"Saving...":"Save Changes"]})]})]}),"completed"===X.status&&(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",display:"flex",alignItems:"center",gap:"0.5rem",margin:0},children:[(0,d.jsx)(s,{style:{width:"1.25rem",height:"1.25rem"}}),"Discount Information"]}),!ap&&(0,d.jsxs)("button",{onClick:()=>aq(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer"},children:[(0,d.jsx)(t.A,{style:{width:"1rem",height:"1rem"}}),X.discountAmount&&X.discountAmount>0?"Edit Discount":"Add Discount"]})]}),(0,d.jsx)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:ap?(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem",display:"block"},children:"Discount Amount (₹)"}),(0,d.jsx)("input",{type:"number",value:ar,onChange:a=>as(a.target.value),min:"0",step:"0.01",placeholder:"Enter discount amount",style:{width:"100%",padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem"}})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem",display:"block"},children:"Offered By (Name/Department)"}),(0,d.jsx)("input",{type:"text",value:at,onChange:a=>au(a.target.value),placeholder:"e.g., Manager Name, Sales Team",style:{width:"100%",padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem"}})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem",display:"block"},children:"Discount Reason"}),(0,d.jsx)("textarea",{value:av,onChange:a=>aw(a.target.value),placeholder:"Reason for discount (e.g., Bulk order, Loyalty customer)",rows:3,style:{width:"100%",padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",resize:"vertical"}})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[(0,d.jsx)("button",{onClick:()=>{aq(!1),X&&(as(X.discountAmount?.toString()||""),au(X.discountOfferedBy||""),aw(X.discountReason||""))},style:{padding:"0.5rem 1rem",backgroundColor:"#f3f4f6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer"},children:"Cancel"}),(0,d.jsxs)("button",{onClick:async()=>{if(X)try{ay(!0);let a=parseFloat(ar)||0,b=X.totalAmount>0?a/X.totalAmount*100:0,{data:d}=await az.from("vehicle_inward").select("notes").eq("id",X.id).single(),e={};if(d?.notes)try{e=JSON.parse(d.notes)}catch{e={}}e.discount={discount_amount:a,discount_percentage:b,discount_offered_by:at,discount_reason:av};let{error:f}=await az.from("vehicle_inward").update({notes:JSON.stringify(e)}).eq("id",X.id);if(f)throw f;let g={...X,discountAmount:a,discountPercentage:b,discountOfferedBy:at,discountReason:av,finalAmount:X.totalAmount-a};Y(g),"completed"===c&&E(D.map(a=>a.id===X.id?g:a)),aq(!1),alert("Discount information saved successfully!"),await aB()}catch(a){console.error("Error saving discount:",a),alert(`Failed to save discount: ${a.message}`)}finally{ay(!1)}},disabled:ax,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:ax?"#9ca3af":"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:ax?"not-allowed":"pointer"},children:[(0,d.jsx)(v.A,{style:{width:"1rem",height:"1rem"}}),ax?"Saving...":"Save Discount"]})]})]}):(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Discount Amount"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:X.discountAmount&&X.discountAmount>0?"#ef4444":"#9ca3af"},children:X.discountAmount&&X.discountAmount>0?aU(X.discountAmount):"No discount"})]}),X.discountAmount&&X.discountAmount>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Discount Percentage"}),(0,d.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#ef4444"},children:[X.discountPercentage?.toFixed(2)||"0","%"]})]}),X.discountOfferedBy&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Offered By"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:X.discountOfferedBy})]}),X.discountReason&&(0,d.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,d.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Reason"}),(0,d.jsx)("div",{style:{fontSize:"0.875rem",color:"#374151"},children:X.discountReason})]}),(0,d.jsx)("div",{style:{gridColumn:"1 / -1",padding:"1rem",backgroundColor:"white",borderRadius:"0.5rem",marginTop:"0.5rem",border:"1px solid #e5e7eb"},children:(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsx)("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#374151"},children:"Final Amount (After Discount):"}),(0,d.jsx)("span",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#10b981"},children:aU(X.finalAmount||X.totalAmount)})]})})]})]})})]}),(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,d.jsx)(g.A,{style:{width:"1.25rem",height:"1.25rem"}}),"Invoice References (Optional)"]}),(0,d.jsxs)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"0.75rem",padding:"1.25rem",border:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{marginBottom:"1rem"},children:(0,d.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,d.jsx)("input",{type:"text",placeholder:"Paste invoice link (URL)",value:ad,onChange:a=>ae(a.target.value),style:{flex:1,padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem"}}),(0,d.jsxs)("button",{onClick:aZ,disabled:!ad.trim()||aj,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem",backgroundColor:aj||!ad.trim()?"#9ca3af":"#2563eb",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:aj||!ad.trim()?"not-allowed":"pointer"},children:[(0,d.jsx)(w,{style:{width:"1rem",height:"1rem"}}),"Add Link"]})]})}),(0,d.jsx)("div",{style:{marginBottom:"1rem"},children:(0,d.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,d.jsxs)("label",{style:{flex:1,padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:af?"#111827":"#9ca3af"},children:[(0,d.jsx)(x.A,{style:{width:"1rem",height:"1rem"}}),(0,d.jsx)("input",{type:"file",accept:"image/*,.pdf",onChange:a=>ag(a.target.files?.[0]||null),style:{display:"none"}}),af?af.name:"Upload Invoice (PDF/Image)"]}),(0,d.jsxs)("button",{onClick:a$,disabled:!af||aj,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem",backgroundColor:aj||!af?"#9ca3af":"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:aj||!af?"not-allowed":"pointer"},children:[(0,d.jsx)(x.A,{style:{width:"1rem",height:"1rem"}}),"Upload"]})]})}),ah.length>0&&(0,d.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e5e7eb"},children:[(0,d.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem"},children:"Added References:"}),(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:ah.map((a,b)=>(0,d.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:"0.5rem"},children:["link"===a.type?(0,d.jsx)(w,{style:{width:"1rem",height:"1rem",color:"#2563eb"}}):(0,d.jsx)(y,{style:{width:"1rem",height:"1rem",color:"#059669"}}),(0,d.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",style:{flex:1,fontSize:"0.875rem",color:"#2563eb",textDecoration:"none"},children:a.fileName||a.url.substring(0,50)})]},b))})]})]})]}),(0,d.jsx)("div",{style:{marginBottom:"2rem"},children:(0,d.jsx)(A.A,{vehicleId:X.id,userRole:an})}),(0,d.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"space-between",alignItems:"center",paddingTop:"1rem",borderTop:"2px solid #e5e7eb"},children:["installation_complete"===X.status&&(0,d.jsxs)("button",{onClick:a_,disabled:al,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:al?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"700",cursor:al?"not-allowed":"pointer",transition:"all 0.2s",boxShadow:al?"none":"0 2px 4px rgba(16, 185, 129, 0.2)"},onMouseEnter:a=>{al||(a.currentTarget.style.backgroundColor="#059669")},onMouseLeave:a=>{al||(a.currentTarget.style.backgroundColor="#10b981")},children:[(0,d.jsx)(j.A,{style:{width:"1.125rem",height:"1.125rem"}}),al?"Marking Complete...":"Mark as Complete"]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"1rem",marginLeft:"auto"},children:[(0,d.jsxs)("button",{onClick:()=>{aW(["Product,Brand,Department,Price",...X.products.map(a=>[a.product,a.brand,V.get(a.department)||a.department,a.price.toString()]).map(a=>a.map(a=>`"${a}"`).join(","))].join("\n"),`entry_${X.shortId||X.id.substring(0,8)}.csv`)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="#047857",onMouseLeave:a=>a.currentTarget.style.backgroundColor="#059669",children:[(0,d.jsx)(f.A,{style:{width:"1rem",height:"1rem"}}),"Export CSV"]}),(0,d.jsx)("button",{onClick:()=>Y(null),style:{padding:"0.625rem 1.25rem",backgroundColor:"#f3f4f6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="#e5e7eb",onMouseLeave:a=>a.currentTarget.style.backgroundColor="#f3f4f6",children:"Close"})]})]})]})]})})]})}},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},43700:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},49524:(a,b,c)=>{Promise.resolve().then(c.bind(c,29100))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67748:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},69957:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},70045:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},89023:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},89710:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(28731).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},96788:(a,b,c)=>{Promise.resolve().then(c.bind(c,15893))}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[586,999,23,377,241],()=>b(b.s=15458));module.exports=c})();