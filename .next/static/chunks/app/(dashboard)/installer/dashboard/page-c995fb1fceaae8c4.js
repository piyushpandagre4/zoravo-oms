(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{1022:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var i=t(95155),s=t(12115),o=t(20063),n=t(26983),l=t(16485),d=t(27816),a=t(8525);function c(){let[e,r]=(0,s.useState)([]),[t,c]=(0,s.useState)(!0);(0,o.useRouter)();let m=(0,a.U)();(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{c(!0);let{data:{user:e}}=await m.auth.getUser();if(!e)return;let{data:t}=await m.from("profiles").select("id, name, email").eq("id",e.id).single();if(!t)return;let{data:i,error:s}=await m.from("vehicle_inward").select("\n          *,\n          vehicles:vehicle_id (\n            id,\n            registration_number,\n            make,\n            model,\n            customers:customer_id (\n              name\n            )\n          )\n        ").in("status",["in_progress","pending"]).order("created_at",{ascending:!1}).limit(10);if(s)throw s;let o=(i||[]).map(e=>{var r,t,i,s,o;return{id:e.id,registration_number:(null==(r=e.vehicles)?void 0:r.registration_number)||"N/A",customer_name:(null==(i=e.vehicles)||null==(t=i.customers)?void 0:t.name)||"N/A",vehicle_make:(null==(s=e.vehicles)?void 0:s.make)||"",vehicle_model:(null==(o=e.vehicles)?void 0:o.model)||"",status:e.status,priority:e.priority,assigned_installer_id:e.assigned_installer_id,estimated_completion_date:e.estimated_completion_date,issues_reported:e.issues_reported,accessories_requested:e.accessories_requested,created_at:e.created_at,updated_at:e.updated_at}});r(o)}catch(e){console.error("Error loading installer work:",e)}finally{c(!1)}},u=async(e,r)=>{try{let{error:t}=await m.from("vehicle_inward").update({status:r,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t;alert("Status updated successfully!"),h()}catch(e){console.error("Error updating status:",e),alert("Failed to update status")}},g=e=>{switch(e.toLowerCase()){case"completed":return{bg:"#dcfce7",color:"#166534"};case"in_progress":return{bg:"#dbeafe",color:"#1e40af"};case"pending":return{bg:"#fef3c7",color:"#92400e"};default:return{bg:"#f1f5f9",color:"#64748b"}}},f=e=>{switch(null==e?void 0:e.toLowerCase()){case"high":return{bg:"#fee2e2",color:"#dc2626"};case"medium":return{bg:"#fef3c7",color:"#d97706"};case"low":return{bg:"#dbeafe",color:"#2563eb"};default:return{bg:"#f1f5f9",color:"#64748b"}}};return t?(0,i.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,i.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Loading your work assignments..."})]})}):(0,i.jsxs)("div",{style:{backgroundColor:"#f8fafc",minHeight:"100vh",padding:"2rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b",marginBottom:"0.5rem"},children:"Your Work Dashboard"}),(0,i.jsx)("p",{style:{fontSize:"1rem",color:"#64748b"},children:"View and manage your assigned installation work"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[(0,i.jsx)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"0.75rem",border:"1px solid #e2e8f0",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{padding:"1rem",backgroundColor:"#dbeafe",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(n.A,{style:{width:"2rem",height:"2rem",color:"#2563eb"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"#1e293b"},children:e.filter(e=>"in_progress"===e.status).length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"In Progress"})]})]})}),(0,i.jsx)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"0.75rem",border:"1px solid #e2e8f0",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{padding:"1rem",backgroundColor:"#fef3c7",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(l.A,{style:{width:"2rem",height:"2rem",color:"#d97706"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"#1e293b"},children:e.filter(e=>"pending"===e.status).length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Pending"})]})]})}),(0,i.jsx)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"0.75rem",border:"1px solid #e2e8f0",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{padding:"1rem",backgroundColor:"#dcfce7",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(d.A,{style:{width:"2rem",height:"2rem",color:"#059669"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"#1e293b"},children:e.length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Total Assignments"})]})]})})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",border:"1px solid #e2e8f0",overflow:"hidden"},children:[(0,i.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",margin:0},children:"Your Assigned Vehicles"}),(0,i.jsx)("button",{onClick:h,style:{padding:"0.5rem 1rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:"Refresh"})]}),(0,i.jsx)("div",{style:{overflow:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8fafc"},children:[(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Vehicle"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Customer"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Priority"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Issues"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Due Date"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:0===e.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:7,style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"No vehicles assigned to you yet."})}):e.map((r,t)=>{var s,o;return(0,i.jsxs)("tr",{style:{borderBottom:t<e.length-1?"1px solid #f1f5f9":"none"},children:[(0,i.jsxs)("td",{style:{padding:"1rem",fontSize:"0.875rem",color:"#1e293b"},children:[(0,i.jsx)("div",{style:{fontWeight:"600"},children:r.registration_number}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:[r.vehicle_make," ",r.vehicle_model]})]}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",color:"#1e293b"},children:r.customer_name}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500",backgroundColor:f(r.priority).bg,color:f(r.priority).color},children:(null==(s=r.priority)?void 0:s.toUpperCase())||"MEDIUM"})}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",color:"#64748b",maxWidth:"200px"},children:(0,i.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:r.issues_reported||r.accessories_requested,children:r.issues_reported||r.accessories_requested||"N/A"})}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",color:"#64748b"},children:(o=r.estimated_completion_date)?new Date(o).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"Not set"}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500",backgroundColor:g(r.status).bg,color:g(r.status).color},children:r.status.replace("_"," ").toUpperCase()})}),(0,i.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem"},children:(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:["pending"===r.status&&(0,i.jsx)("button",{onClick:()=>u(r.id,"in_progress"),style:{padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500",cursor:"pointer"},children:"Start Work"}),"in_progress"===r.status&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("button",{onClick:()=>u(r.id,"completed"),style:{padding:"0.5rem 1rem",backgroundColor:"#059669",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500",cursor:"pointer"},children:"Mark Complete"})}),"completed"===r.status&&(0,i.jsx)("span",{style:{color:"#059669",fontSize:"0.75rem"},children:"âœ“ Completed"})]})})]},r.id)})})]})})]})]})}},2194:(e,r,t)=>{Promise.resolve().then(t.bind(t,1022))},8525:(e,r,t)=>{"use strict";t.d(r,{U:()=>s});var i=t(88727);function s(){return(0,i.createBrowserClient)("https://fszlchqifmvssxxgygij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZzemxjaHFpZm12c3N4eGd5Z2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3Njk4NzAsImV4cCI6MjA3NjM0NTg3MH0.-cwWKc1l3Af4zjOYIfRIH_bOMuTU82XD8dNK73_qPTE")}},16485:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},20063:(e,r,t)=>{"use strict";var i=t(47260);t.o(i,"useParams")&&t.d(r,{useParams:function(){return i.useParams}}),t.o(i,"usePathname")&&t.d(r,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(r,{useRouter:function(){return i.useRouter}}),t.o(i,"useSearchParams")&&t.d(r,{useSearchParams:function(){return i.useSearchParams}})},26983:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},27816:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])}},e=>{e.O(0,[331,441,255,358],()=>e(e.s=2194)),_N_E=e.O()}]);