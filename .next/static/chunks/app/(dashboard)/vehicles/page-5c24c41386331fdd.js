(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{6191:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},20063:(e,r,t)=>{"use strict";var i=t(47260);t.o(i,"useParams")&&t.d(r,{useParams:function(){return i.useParams}}),t.o(i,"usePathname")&&t.d(r,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(r,{useRouter:function(){return i.useRouter}}),t.o(i,"useSearchParams")&&t.d(r,{useSearchParams:function(){return i.useSearchParams}})},20508:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},21873:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},23664:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},24326:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},26617:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},50465:(e,r,t)=>{Promise.resolve().then(t.bind(t,95367))},53842:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])},63581:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},69141:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},70408:(e,r,t)=>{"use strict";t.d(r,{MD:()=>o,hZ:()=>l}),t(20063),t(88727);var i=t(8525);async function o(){let e=(0,i.U)(),{data:{user:r}}=await e.auth.getUser();if(!r)return null;let{data:t,error:o}=await e.from("profiles").select("*").eq("id",r.id).single();return o||!t?null:t}function l(e){return[{title:"Dashboard",href:"/dashboard",icon:"LayoutDashboard",roles:["admin","manager","coordinator","installer","accountant"]},{title:"Vehicle Inward",href:"/inward/new",icon:"Car",roles:["admin","manager","coordinator"]},{title:"Vehicle Management",href:"/vehicles",icon:"Truck",roles:["admin","manager","coordinator"]},{title:"Trackers",href:"/trackers",icon:"Activity",roles:["admin","manager","coordinator"]},{title:"Accounts",href:"/accounts",icon:"DollarSign",roles:["admin","accountant"],children:[{title:"Invoices",href:"/accounts/invoices",icon:"FileText",roles:["admin","accountant"]},{title:"Reports",href:"/accounts/reports",icon:"BarChart3",roles:["admin","accountant"]}]},{title:"Settings",href:"/settings",icon:"Settings",roles:["admin","manager","installer","coordinator","accountant"]},{title:"About",href:"/about",icon:"Settings",roles:["admin","manager","installer","coordinator","accountant"]}].filter(r=>{if(Array.isArray(r.children)){let t=r.children.filter(r=>r.roles.includes(e));return r.roles.includes(e)&&t.length>0}return r.roles.includes(e)})}},86651:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(45105).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},95367:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>A});var i=t(95155),o=t(12115),l=t(20063),n=t(89715),s=t(6191),d=t(24947),a=t(53842),c=t(16485),m=t(86651),h=t(63581),g=t(69141),p=t(23664);let x=(0,t(45105).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var f=t(24326),u=t(71360),y=t(8525),b=t(65229),j=t(20508),v=t(21873),S=t(91761),w=t(26617),C=t(85832);function k(e){var r,t;let{vehicle:l,onClose:n,onUpdate:s}=e,m=(0,y.U)(),[h,x]=(0,o.useState)("Loading..."),[f,u]=(0,o.useState)("Loading..."),[k,_]=(0,o.useState)("Loading..."),[A,z]=(0,o.useState)(""),[I,R]=(0,o.useState)([]),[B,W]=(0,o.useState)(l.status||"pending"),[D,N]=(0,o.useState)(!1);(0,o.useEffect)(()=>{P(),E()},[l]);let P=async()=>{try{if(l.assigned_manager_id){let{data:e}=await m.from("profiles").select("name").eq("id",l.assigned_manager_id).single();x((null==e?void 0:e.name)||"Not Assigned")}else x("Not Assigned");if(l.location_id){let{data:e}=await m.from("locations").select("name").eq("id",l.location_id).single();u((null==e?void 0:e.name)||"Not Specified")}else u("Not Specified");if(l.vehicle_type){let{data:e}=await m.from("vehicle_types").select("name").eq("id",l.vehicle_type).single();_((null==e?void 0:e.name)||l.vehicle_type||"Not Specified")}else _("Not Specified");if(l.assigned_installer_id){let{data:e}=await m.from("profiles").select("name").eq("id",l.assigned_installer_id).single();z((null==e?void 0:e.name)||"Not Assigned")}}catch(e){console.error("Error fetching related data:",e),x("Error loading"),u("Error loading"),_("Error loading")}},E=async()=>{if(l.accessories_requested)try{let e=JSON.parse(l.accessories_requested);if(Array.isArray(e)){let r=await Promise.all(e.map(async e=>{if(e.department&&"string"==typeof e.department&&e.department.includes("-"))try{let{data:r}=await m.from("departments").select("name").eq("id",e.department).single();return{...e,department:(null==r?void 0:r.name)||e.department}}catch(e){}return e}));R(r)}else R([])}catch(e){R([])}else R([])},L=async e=>{if(!D){N(!0);try{let{error:r}=await m.from("vehicle_inward").update({status:e}).eq("id",l.id);if(r)throw r;W(e),s&&s(),alert("Status updated successfully!")}catch(e){console.error("Error updating status:",e),alert("Failed to update status: ".concat(e.message))}finally{N(!1)}}},M=(()=>{let e=B.toLowerCase();return"pending"===e?["In Progress"]:"in_progress"===e?["Under Installation"]:"under_installation"===e?["Installation Complete"]:"installation_complete"===e?["Complete and Delivered"]:[]})(),U=l.priority||"medium",q={pending:{bg:"#fef3c7",text:"#92400e"},in_progress:{bg:"#dbeafe",text:"#1e40af"},under_installation:{bg:"#f3e8ff",text:"#7c3aed"},installation_complete:{bg:"#d1fae5",text:"#059669"},complete_and_delivered:{bg:"#dcfce7",text:"#166534"},completed:{bg:"#dcfce7",text:"#166534"},delivered:{bg:"#bbf7d0",text:"#15803d"}}[B]||{bg:"#f1f5f9",text:"#64748b"},T={low:{bg:"#dcfce7",text:"#166534"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#dc2626"},urgent:{bg:"#fecaca",text:"#991b1b"}}[U]||{bg:"#f1f5f9",text:"#64748b"};return(0,i.jsx)("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},onClick:n,children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",width:"100%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#1e293b",margin:0},children:"Vehicle Inward Details"}),(0,i.jsxs)("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0.25rem 0 0 0"},children:["ID: ",l.short_id||(null==(r=l.id)?void 0:r.substring(0,8))+"..."]})]}),(0,i.jsx)("button",{onClick:n,style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(b.A,{style:{width:"1.5rem",height:"1.5rem",color:"#64748b"}})})]}),(0,i.jsxs)("div",{style:{padding:"1.5rem",overflowY:"auto",flex:1},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[(0,i.jsxs)("span",{style:{padding:"0.5rem 1rem",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:q.bg,color:q.text},children:["Status: ",B.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())]}),(0,i.jsxs)("span",{style:{padding:"0.5rem 1rem",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:T.bg,color:T.text},children:["Priority: ",U.toUpperCase()]})]}),M.length>0&&(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#f0f9ff",borderRadius:"0.5rem",border:"1px solid #bae6fd"},children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#1e293b",marginBottom:"0.5rem"},children:"Update Status"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,i.jsxs)("select",{value:"",onChange:e=>{e.target.value&&L(e.target.value)},disabled:D,style:{flex:1,padding:"0.5rem",border:"1px solid #e2e8f0",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none",cursor:D?"not-allowed":"pointer"},children:[(0,i.jsx)("option",{value:"",children:"Select new status..."}),M.map(e=>(0,i.jsx)("option",{value:e.toLowerCase().replace(/\s+/g,"_"),children:e},e))]}),D&&(0,i.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Updating..."})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(j.A,{style:{width:"1rem",height:"1rem",color:"#64748b"}}),"Customer Information"]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f8fafc",padding:"1rem",borderRadius:"0.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Name:"})," ",l.customer_name||"N/A"]}),(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(g.A,{style:{width:"0.875rem",height:"0.875rem",color:"#64748b"}}),(0,i.jsx)("a",{href:"tel:".concat(l.customer_phone),style:{color:"#2563eb",textDecoration:"none"},children:l.customer_phone||"N/A"})]}),l.customer_email&&(0,i.jsxs)("div",{style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(p.A,{style:{width:"0.875rem",height:"0.875rem",color:"#64748b"}}),(0,i.jsx)("a",{href:"mailto:".concat(l.customer_email),style:{color:"#2563eb",textDecoration:"none"},children:l.customer_email})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(d.A,{style:{width:"1rem",height:"1rem",color:"#64748b"}}),"Vehicle Information"]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f8fafc",padding:"1rem",borderRadius:"0.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Registration:"})," ",l.registration_number||"N/A"]}),(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Model:"})," ",l.model||"N/A"]}),(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Make:"})," ",l.make||"N/A"]}),(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Type:"})," ",k]}),l.year&&(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Year:"})," ",l.year]}),l.color&&(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Color:"})," ",l.color]}),l.odometer_reading&&(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Odometer:"})," ",l.odometer_reading," km"]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:["Created: ",l.created_at?new Date(l.created_at).toLocaleString("en-IN"):"Unknown"]})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(a.A,{style:{width:"1rem",height:"1rem",color:"#64748b"}}),"Assignment Details"]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f8fafc",padding:"1rem",borderRadius:"0.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"0.75rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Manager:"}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{style:{color:"#64748b"},children:h})]}),A&&(0,i.jsxs)("div",{style:{marginBottom:"0.75rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Installer:"}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{style:{color:"#64748b"},children:A})]}),(0,i.jsxs)("div",{style:{marginBottom:"0.75rem",fontSize:"0.875rem",display:"flex",alignItems:"start",gap:"0.5rem"},children:[(0,i.jsx)(v.A,{style:{width:"0.875rem",height:"0.875rem",color:"#64748b",marginTop:"0.125rem",flexShrink:0}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Location:"}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{style:{color:"#64748b"},children:f})]})]}),l.estimated_completion_date&&(0,i.jsxs)("div",{style:{fontSize:"0.875rem",display:"flex",alignItems:"start",gap:"0.5rem"},children:[(0,i.jsx)(c.A,{style:{width:"0.875rem",height:"0.875rem",color:"#64748b",marginTop:"0.125rem",flexShrink:0}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Est. Completion:"}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{style:{color:"#64748b"},children:new Date(l.estimated_completion_date).toLocaleDateString("en-IN")})]})]})]})]}),void 0!==l.estimated_cost&&null!==l.estimated_cost&&(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(S.A,{style:{width:"1rem",height:"1rem",color:"#64748b"}}),"Cost & Revenue"]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f8fafc",padding:"1rem",borderRadius:"0.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Estimated Cost:"})," ₹",(null==(t=l.estimated_cost)?void 0:t.toLocaleString("en-IN"))||"0"]}),(0,i.jsxs)("div",{style:{fontSize:"0.875rem"},children:[(0,i.jsx)("strong",{children:"Payment Status:"})," ","complete_and_delivered"===B||"completed"===B?"Paid":"Pending Payment"]})]})]})]})]}),I.length>0&&(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(w.A,{style:{width:"1rem",height:"1rem",color:"#64748b"}}),"Product Details"]}),(0,i.jsx)("div",{style:{backgroundColor:"#f8fafc",padding:"1rem",borderRadius:"0.5rem"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[(0,i.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",color:"#64748b",fontWeight:"500"},children:"Product"}),(0,i.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",color:"#64748b",fontWeight:"500"},children:"Brand"}),(0,i.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",color:"#64748b",fontWeight:"500"},children:"Department"}),(0,i.jsx)("th",{style:{padding:"0.5rem",textAlign:"right",color:"#64748b",fontWeight:"500"},children:"Price"})]})}),(0,i.jsx)("tbody",{children:I.map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:r===I.length-1?"none":"1px solid #e2e8f0"},children:[(0,i.jsx)("td",{style:{padding:"0.5rem"},children:e.product||"-"}),(0,i.jsx)("td",{style:{padding:"0.5rem"},children:e.brand||"-"}),(0,i.jsx)("td",{style:{padding:"0.5rem"},children:e.department||"-"}),(0,i.jsxs)("td",{style:{padding:"0.5rem",textAlign:"right"},children:["₹",parseFloat(e.price||0).toLocaleString("en-IN")]})]},r))})]})})]}),(l.issues_reported||l.notes)&&(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.75rem"},children:"Additional Information"}),l.issues_reported&&(0,i.jsxs)("div",{style:{marginBottom:"0.75rem",backgroundColor:"#fef2f2",padding:"1rem",borderRadius:"0.5rem",borderLeft:"4px solid #dc2626"},children:[(0,i.jsx)("strong",{style:{color:"#dc2626",fontSize:"0.875rem",display:"block",marginBottom:"0.5rem"},children:"Issues Reported:"}),(0,i.jsx)("p",{style:{margin:0,fontSize:"0.875rem",color:"#991b1b",whiteSpace:"pre-wrap"},children:l.issues_reported})]}),l.notes&&(0,i.jsxs)("div",{style:{backgroundColor:"#f0f9ff",padding:"1rem",borderRadius:"0.5rem",borderLeft:"4px solid #2563eb"},children:[(0,i.jsx)("strong",{style:{color:"#2563eb",fontSize:"0.875rem",display:"block",marginBottom:"0.5rem"},children:"Notes:"}),(0,i.jsx)("p",{style:{margin:0,fontSize:"0.875rem",color:"#1e40af",whiteSpace:"pre-wrap"},children:l.notes})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(C.A,{vehicleId:l.id,userRole:"admin"})})]}),(0,i.jsx)("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"flex-end",alignItems:"center"},children:(0,i.jsx)("button",{onClick:n,style:{padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:"Close"})})]})})}var _=t(70408);function A(){let[e,r]=(0,o.useState)(""),[t,b]=(0,o.useState)("all"),[j,v]=(0,o.useState)([]),[S,w]=(0,o.useState)(!1),[C,A]=(0,o.useState)(null),[z,I]=(0,o.useState)(!1),[R,B]=(0,o.useState)(null),W=(0,l.useRouter)(),D=(0,y.U)(),[N,P]=(0,o.useState)([]);(0,o.useEffect)(()=>{E(),L()},[]);let E=async()=>{let e=await (0,_.MD)();e&&B(e.role)},L=async()=>{try{let{data:e,error:r}=await D.from("vehicle_inward").select("*").order("created_at",{ascending:!1});if(r)return void console.error("Error fetching vehicles:",r);if(e&&e.length>0){let r=e.map(e=>({id:e.id,shortId:e.short_id||e.id.substring(0,8),regNo:e.registration_number||"N/A",make:e.make&&"Unknown"!==e.make?e.make:"N/A",model:e.model||"N/A",year:e.year,color:e.color,customer:e.customer_name||"N/A",customerPhone:e.customer_phone,customerEmail:e.customer_email,customerAddress:e.customer_address,customerCity:e.customer_city,customerState:e.customer_state,customerPincode:e.customer_pincode,status:e.status||"pending",date:new Date(e.created_at).toISOString().split("T")[0],issues:e.issues_reported,accessories:e.accessories_requested,estimatedCost:e.estimated_cost,priority:e.priority,odometerReading:e.odometer_reading,totalServices:e.total_services||0,nextService:e.next_service_date||"N/A",fullData:e}));P(r)}}catch(e){console.error("Error loading vehicles:",e)}},M=N.filter(r=>{var i;let o=r.regNo.toLowerCase().includes(e.toLowerCase())||r.make.toLowerCase().includes(e.toLowerCase())||r.model.toLowerCase().includes(e.toLowerCase())||r.customer.toLowerCase().includes(e.toLowerCase()),l=(null==(i=r.status)?void 0:i.toLowerCase().trim())||"",n=!1;return n="all"===t?!["delivered","complete_and_delivered"].includes(l):l===t||"completed"===t&&("completed"===l||"complete_and_delivered"===l)||"delivered"===t&&("delivered"===l||"complete_and_delivered"===l),o&&n}),U=async(e,r)=>{w(!0);try{console.log("Updating vehicle inward status:",{vehicleId:e,newStatus:r});let{data:t,error:i}=await D.from("vehicle_inward").update({status:r,updated_at:new Date().toISOString()}).eq("id",e).select();if(console.log("Update result:",{data:t,error:i}),i)throw console.error("Supabase error:",i),Error("Database error: ".concat(i.message||"Unknown error"));if(!t||0===t.length)throw Error("No vehicle inward record found with ID: ".concat(e));P(t=>t.map(t=>t.id===e?{...t,status:r}:t));let o=r.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase());alert("Status updated to: ".concat(o))}catch(e){console.error("Error updating vehicle status:",e),alert("Failed to update vehicle status: ".concat(e.message))}finally{w(!1)}},q=async(e,r)=>{if(confirm("Are you sure you want to delete this vehicle inward record? This action cannot be undone."))try{let{error:r}=await D.from("vehicle_inward").delete().eq("id",e);if(r)throw console.error("Supabase error:",r),Error("Database error: ".concat(r.message));P(r=>r.filter(r=>r.id!==e)),alert("Record deleted successfully"),L()}catch(e){console.error("Error deleting vehicle:",e),alert("Failed to delete record: ".concat(e.message))}};return(0,i.jsxs)("div",{style:{padding:"1.5rem",backgroundColor:"#f8fafc",minHeight:"100%"},children:[z&&C&&(0,i.jsx)(k,{vehicle:C,onClose:()=>{I(!1),A(null)},onUpdate:()=>{L()}}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:"2.25rem",fontWeight:"bold",color:"#1e293b",margin:0},children:"Vehicle Management"}),(0,i.jsx)("p",{style:{fontSize:"1rem",color:"#64748b",margin:"0.5rem 0 0 0"},children:"Manage vehicle records, service history, and customer information"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,i.jsxs)("button",{onClick:()=>alert("Export vehicles data"),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#059669",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:"500",cursor:"pointer",boxShadow:"0 2px 5px rgba(5,150,105,0.2)",transition:"all 0.2s"},children:[(0,i.jsx)(n.A,{style:{width:"1rem",height:"1rem"}}),"Export"]}),(0,i.jsxs)("button",{onClick:()=>W.push("/inward/new"),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:"500",cursor:"pointer",boxShadow:"0 2px 5px rgba(37,99,235,0.2)",transition:"all 0.2s"},children:[(0,i.jsx)(s.A,{style:{width:"1rem",height:"1rem"}}),"Add Vehicle"]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",borderRadius:"50%",backgroundColor:"#eff6ff",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(d.A,{style:{width:"1.5rem",height:"1.5rem",color:"#2563eb"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:N.length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Total Vehicles"})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",borderRadius:"50%",backgroundColor:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(a.A,{style:{width:"1.5rem",height:"1.5rem",color:"#f59e0b"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:N.filter(e=>["in_progress","under_installation"].includes(e.status)).length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"In Progress"})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",borderRadius:"50%",backgroundColor:"#dcfce7",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(c.A,{style:{width:"1.5rem",height:"1.5rem",color:"#059669"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:N.filter(e=>["completed","delivered"].includes(e.status)).length}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Completed"})]})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",marginBottom:"1.5rem",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{position:"relative",width:"400px"},children:[(0,i.jsx)(m.A,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem",color:"#94a3b8"}}),(0,i.jsx)("input",{type:"text",placeholder:"Search vehicles by registration, make, model, or customer...",value:e,onChange:e=>r(e.target.value),style:{padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"0.375rem",fontSize:"0.875rem",width:"100%",outline:"none",backgroundColor:"white",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:e=>{e.target.style.borderColor="#2563eb",e.target.style.boxShadow="0 0 0 2px rgba(37,99,235,0.2)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="none"}})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem"},children:(0,i.jsxs)("button",{onClick:()=>alert("Advanced filters"),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"white",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:[(0,i.jsx)(h.A,{style:{width:"1rem",height:"1rem"}}),"Filters"]})})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem"},children:["all","pending","in_progress","under_installation","installation_complete","completed","delivered"].map(e=>(0,i.jsx)("button",{onClick:()=>b(e),style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",border:"1px solid #e2e8f0",backgroundColor:t===e?"#2563eb":"white",color:t===e?"white":"#64748b",transition:"all 0.2s"},children:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},e))})]}),(0,i.jsx)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569",width:"50px"},children:(0,i.jsx)("input",{type:"checkbox",checked:j.length===M.length&&M.length>0,onChange:()=>{j.length===M.length?v([]):v(M.map(e=>e.id))},style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"ID"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Vehicle"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Customer"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Contact"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Service Info"}),(0,i.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#475569"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:0===M.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:8,style:{textAlign:"center",padding:"2rem",color:"#64748b"},children:"No vehicles found."})}):M.map((e,r)=>{var t;return(0,i.jsxs)("tr",{style:{borderBottom:r===M.length-1?"none":"1px solid #f1f5f9"},children:[(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem"},children:(0,i.jsx)("input",{type:"checkbox",checked:j.includes(e.id),onChange:()=>{var r;return r=e.id,void v(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem",color:"#1e293b",fontWeight:"500"},children:e.shortId||e.id}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem",color:"#1e293b"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:"500"},children:e.model}),(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:e.regNo}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:[e.year?"".concat(e.year," • "):"",e.color]})]})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem",color:"#1e293b"},children:(0,i.jsx)("div",{children:(0,i.jsx)("div",{style:{fontWeight:"500"},children:e.customer})})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem",color:"#1e293b"},children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[(0,i.jsxs)("a",{href:"tel:".concat(e.customerPhone),style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"#2563eb",textDecoration:"none"},children:[(0,i.jsx)(g.A,{style:{width:"0.75rem",height:"0.75rem",color:"#64748b"}}),e.customerPhone]}),(0,i.jsxs)("a",{href:"mailto:".concat(e.customerEmail),style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"#2563eb",textDecoration:"none"},children:[(0,i.jsx)(p.A,{style:{width:"0.75rem",height:"0.75rem",color:"#64748b"}}),e.customerEmail||"N/A"]})]})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem"},children:["delivered","complete_and_delivered"].includes((null==(t=e.status)?void 0:t.toLowerCase().trim())||"")?(0,i.jsxs)("div",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.375rem",fontSize:"0.75rem",backgroundColor:"#f3f4f6",color:"#6b7280",minWidth:"150px",textAlign:"center",border:"1px solid #e5e7eb",cursor:"not-allowed",fontStyle:"italic"},children:[e.status.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")," (Final)"]}):(0,i.jsxs)("select",{value:e.status,onChange:r=>U(e.id,r.target.value),disabled:S,style:{padding:"0.25rem 0.5rem",borderRadius:"0.375rem",border:"1px solid #e2e8f0",fontSize:"0.75rem",backgroundColor:"white",cursor:S?"not-allowed":"pointer",minWidth:"150px"},children:[(0,i.jsx)("option",{value:"pending",children:"Pending"}),(0,i.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,i.jsx)("option",{value:"under_installation",children:"Under Installation"}),(0,i.jsx)("option",{value:"installation_complete",children:"Installation Complete"}),(0,i.jsx)("option",{value:"completed",children:"Completed"}),(0,i.jsx)("option",{value:"delivered",children:"Delivered"})]})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem",color:"#64748b",maxWidth:"250px"},children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[(0,i.jsxs)("div",{style:{fontSize:"0.75rem"},children:[(0,i.jsx)("strong",{children:"Issue:"})," ",e.issues||"N/A"]}),e.estimatedCost&&(0,i.jsxs)("div",{style:{fontSize:"0.75rem"},children:[(0,i.jsx)("strong",{children:"Cost:"})," ₹",e.estimatedCost]}),e.odometerReading&&(0,i.jsxs)("div",{style:{fontSize:"0.75rem"},children:[(0,i.jsx)("strong",{children:"Odometer:"})," ",e.odometerReading," km"]})]})}),(0,i.jsx)("td",{style:{padding:"0.75rem 1rem",fontSize:"0.875rem"},children:(()=>{var r;let t=["delivered","complete_and_delivered"].includes((null==(r=e.status)?void 0:r.toLowerCase().trim())||""),o=("coordinator"===R||"manager"===R)&&t;return(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsx)("button",{onClick:()=>{A(e.fullData),I(!0)},style:{padding:"0.5rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.75rem",cursor:"pointer"},title:"View Details",children:(0,i.jsx)(x,{style:{width:"0.75rem",height:"0.75rem"}})}),(0,i.jsx)("button",{onClick:()=>{o||(e=>{let r=N.find(r=>r.id===e);r&&r.fullData?(encodeURIComponent(JSON.stringify(r.fullData)),W.push("/inward/edit?id=".concat(e))):alert("Vehicle data not available for editing")})(e.id)},disabled:o,style:{padding:"0.5rem",backgroundColor:o?"#9ca3af":"#059669",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500",cursor:o?"not-allowed":"pointer",boxShadow:o?"none":"0 1px 2px rgba(0,0,0,0.1)",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",opacity:o?.6:1},title:o?"Cannot edit delivered vehicles":"Edit Customer Details",children:(0,i.jsx)(f.A,{style:{width:"0.75rem",height:"0.75rem"}})}),(0,i.jsx)("button",{onClick:()=>{o||q(e.id,e.regNo)},disabled:o,style:{padding:"0.5rem",backgroundColor:o?"#9ca3af":"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.75rem",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},title:o?"Cannot delete delivered vehicles":"Delete",children:(0,i.jsx)(u.A,{style:{width:"0.75rem",height:"0.75rem"}})})]})})()})]},e.id)})})]})}),j.length>0&&(0,i.jsxs)("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",backgroundColor:"#2563eb",color:"white",padding:"1rem 1.5rem",borderRadius:"0.5rem",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsxs)("span",{children:[j.length," vehicles selected"]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsx)("button",{onClick:()=>alert("Export ".concat(j.length," vehicles")),style:{padding:"0.5rem 1rem",backgroundColor:"white",color:"#2563eb",border:"none",borderRadius:"0.25rem",fontSize:"0.875rem",cursor:"pointer"},children:"Export"}),(0,i.jsx)("button",{onClick:()=>alert("Delete ".concat(j.length," vehicles?")),style:{padding:"0.5rem 1rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.25rem",fontSize:"0.875rem",cursor:"pointer"},children:"Delete"})]})]})]})}}},e=>{e.O(0,[331,762,441,255,358],()=>e(e.s=50465)),_N_E=e.O()}]);